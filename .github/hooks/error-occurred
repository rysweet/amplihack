#!/usr/bin/env bash
# Copilot hook: error-occurred
# Calls Python implementation from ~/.amplihack/ (primary) or repo .claude/ (fallback)

HOOK="error_protocol.py"
AMPLIHACK_HOOKS="$HOME/.amplihack/.claude/tools/amplihack/hooks"

if [[ -f "${AMPLIHACK_HOOKS}/${HOOK}" ]]; then
    python3 "${AMPLIHACK_HOOKS}/${HOOK}" "$@"
elif REPO_ROOT="$(git rev-parse --show-toplevel 2>/dev/null)" && [[ -f "${REPO_ROOT}/.claude/tools/amplihack/hooks/${HOOK}" ]]; then
    python3 "${REPO_ROOT}/.claude/tools/amplihack/hooks/${HOOK}" "$@"
else
    echo "{}" # No-op if hook not found
fi
