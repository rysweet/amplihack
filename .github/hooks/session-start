#!/usr/bin/env bash
# Copilot hook: session-start
# Calls Python implementation from ~/.amplihack/ (primary) or repo .claude/ (fallback)

HOOK="session_start.py"
AMPLIHACK_HOOKS="$HOME/.amplihack/.claude/tools/amplihack/hooks"

if [[ -f "${AMPLIHACK_HOOKS}/${HOOK}" ]]; then
    exec python3 "${AMPLIHACK_HOOKS}/${HOOK}" "$@"
# Fallback: assign REPO_ROOT inline; short-circuits if not in a git repo
elif REPO_ROOT="$(git rev-parse --show-toplevel 2>/dev/null)" && [[ -f "${REPO_ROOT}/.claude/tools/amplihack/hooks/${HOOK}" ]]; then
    exec python3 "${REPO_ROOT}/.claude/tools/amplihack/hooks/${HOOK}" "$@"
else
    echo "{}"
fi
